
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte Interactive Constantine</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        .legend {
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            line-height: 18px;
            color: #555;
        }
        
        .legend h4 {
            margin: 0 0 5px;
            color: #777;
        }
        
        .legend-item {
            margin: 5px 0;
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            display: inline-block;
            margin-right: 8px;
            border-radius: 50%;
            vertical-align: middle;
        }
        
        .popup-content h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        
        .popup-content p {
            margin: 5px 0;
            color: #555;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading">
        <div>üó∫Ô∏è Chargement de la carte...</div>
    </div>
    <div id="map"></div>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Donn√©es des arr√™ts de bus (points bleus) - COORDONN√âES CORRIG√âES
        const arretsBus = [
            // Constantine Centre historique
            { lat: 36.3700, lng: 6.6160, nom: "Arr√™t Bus Universit√© Constantine 1", type: "bus", id: 1 },
            { lat: 36.3680, lng: 6.6140, nom: "Arr√™t Bus Cit√© Universitaire", type: "bus", id: 2 },
            { lat: 36.3720, lng: 6.6120, nom: "Arr√™t Bus Pont Sidi M'Cid", type: "bus", id: 3 },
            { lat: 36.3650, lng: 6.6180, nom: "Arr√™t Bus Centre-Ville Constantine", type: "bus", id: 4 },
            { lat: 36.3670, lng: 6.6200, nom: "Arr√™t Bus Ciloc", type: "bus", id: 5 },
            
            // Sidi Mabrouk
            { lat: 36.3500, lng: 6.5980, nom: "Arr√™t Bus Sidi Mabrouk Sup√©rieur", type: "bus", id: 11 },
            { lat: 36.3480, lng: 6.6000, nom: "Arr√™t Bus Sidi Mabrouk Centre", type: "bus", id: 12 },
            { lat: 36.3460, lng: 6.6020, nom: "Arr√™t Bus Sidi Mabrouk Inf√©rieur", type: "bus", id: 13 },
            
            // Daksi
            { lat: 36.3400, lng: 6.5900, nom: "Arr√™t Bus Daksi Centre", type: "bus", id: 15 },
            { lat: 36.3380, lng: 6.5880, nom: "Arr√™t Bus Daksi Sud", type: "bus", id: 16 },
            
            // Ain Smara
            { lat: 36.3300, lng: 6.5800, nom: "Arr√™t Bus Ain Smara Centre", type: "bus", id: 18 },
            { lat: 36.3280, lng: 6.5780, nom: "Arr√™t Bus Ain Smara Sud", type: "bus", id: 19 },
            
            // Ain Bey
            { lat: 36.3800, lng: 6.5900, nom: "Arr√™t Bus Ain Bey Centre", type: "bus", id: 37 },
            { lat: 36.3820, lng: 6.5920, nom: "Arr√™t Bus Ain Bey Nord", type: "bus", id: 38 },
            
            // ===== ALI MENDJLI (NOUVELLE VILLE) - COORDONN√âES CORRECTES =====
            // Zone Nord Ali Mendjli (partie haute de la ville nouvelle)
            { lat: 36.3100, lng: 6.5850, nom: "Arr√™t Bus Ali Mendjli Nord 1", type: "bus", id: 25 },
            { lat: 36.3120, lng: 6.5870, nom: "Arr√™t Bus Ali Mendjli Nord 2", type: "bus", id: 26 },
            { lat: 36.3110, lng: 6.5860, nom: "Arr√™t Bus Ali Mendjli Nord 3", type: "bus", id: 27 },
            { lat: 36.3130, lng: 6.5880, nom: "Arr√™t Bus Ali Mendjli Nord 4", type: "bus", id: 28 },
            { lat: 36.3105, lng: 6.5855, nom: "Arr√™t Bus Ali Mendjli Nord 5", type: "bus", id: 29 },
            
            // Zone Centre Ali Mendjli (centre administratif)
            { lat: 36.3070, lng: 6.5820, nom: "Arr√™t Bus Ali Mendjli Centre 1", type: "bus", id: 30 },
            { lat: 36.3080, lng: 6.5830, nom: "Arr√™t Bus Ali Mendjli Centre 2", type: "bus", id: 31 },
            { lat: 36.3060, lng: 6.5810, nom: "Arr√™t Bus Ali Mendjli Centre 3", type: "bus", id: 32 },
            { lat: 36.3090, lng: 6.5840, nom: "Arr√™t Bus Ali Mendjli Centre 4", type: "bus", id: 33 },
            { lat: 36.3075, lng: 6.5825, nom: "Arr√™t Bus Ali Mendjli Centre 5", type: "bus", id: 34 },
            { lat: 36.3085, lng: 6.5835, nom: "Arr√™t Bus Ali Mendjli Centre 6", type: "bus", id: 35 },
            
            // Zone Sud Ali Mendjli (partie r√©sidentielle sud)
            { lat: 36.3030, lng: 6.5780, nom: "Arr√™t Bus Ali Mendjli Sud 1", type: "bus", id: 36 },
            { lat: 36.3020, lng: 6.5770, nom: "Arr√™t Bus Ali Mendjli Sud 2", type: "bus", id: 37 },
            { lat: 36.3040, lng: 6.5790, nom: "Arr√™t Bus Ali Mendjli Sud 3", type: "bus", id: 38 },
            { lat: 36.3010, lng: 6.5760, nom: "Arr√™t Bus Ali Mendjli Sud 4", type: "bus", id: 39 },
            { lat: 36.3035, lng: 6.5785, nom: "Arr√™t Bus Ali Mendjli Sud 5", type: "bus", id: 40 },
            
            // Zone Est Ali Mendjli (extension est)
            { lat: 36.3080, lng: 6.5890, nom: "Arr√™t Bus Ali Mendjli Est 1", type: "bus", id: 41 },
            { lat: 36.3060, lng: 6.5900, nom: "Arr√™t Bus Ali Mendjli Est 2", type: "bus", id: 42 },
            { lat: 36.3100, lng: 6.5910, nom: "Arr√™t Bus Ali Mendjli Est 3", type: "bus", id: 43 },
            { lat: 36.3070, lng: 6.5880, nom: "Arr√™t Bus Ali Mendjli Est 4", type: "bus", id: 44 },
            
            // Zone Ouest Ali Mendjli (vers Constantine)
            { lat: 36.3090, lng: 6.5750, nom: "Arr√™t Bus Ali Mendjli Ouest 1", type: "bus", id: 45 },
            { lat: 36.3070, lng: 6.5740, nom: "Arr√™t Bus Ali Mendjli Ouest 2", type: "bus", id: 46 },
            { lat: 36.3050, lng: 6.5730, nom: "Arr√™t Bus Ali Mendjli Ouest 3", type: "bus", id: 47 },
            { lat: 36.3110, lng: 6.5760, nom: "Arr√™t Bus Ali Mendjli Ouest 4", type: "bus", id: 48 },
            
            // Zone Universitaire Ali Mendjli
            { lat: 36.3140, lng: 6.5800, nom: "Arr√™t Bus Ali Mendjli Universit√© 1", type: "bus", id: 49 },
            { lat: 36.3150, lng: 6.5810, nom: "Arr√™t Bus Ali Mendjli Universit√© 2", type: "bus", id: 50 },
            { lat: 36.3160, lng: 6.5820, nom: "Arr√™t Bus Ali Mendjli Universit√© 3", type: "bus", id: 51 },
            
            // El Khroub
            { lat: 36.4560, lng: 6.6920, nom: "Arr√™t Bus El Khroub Centre", type: "bus", id: 60 },
            { lat: 36.4540, lng: 6.6900, nom: "Arr√™t Bus El Khroub Gare", type: "bus", id: 61 }
        ];
        
        // Donn√©es des stations de taxi (points jaunes) - ALI MENDJLI CORRIG√â
        const arretsTaxi = [
            // Constantine Centre
            { lat: 36.3665, lng: 6.6150, nom: "Station Taxi Place 1er Nov", type: "taxi", id: 1 },
            { lat: 36.3685, lng: 6.6170, nom: "Station Taxi Universit√©", type: "taxi", id: 2 },
            { lat: 36.3645, lng: 6.6130, nom: "Station Taxi Bardo", type: "taxi", id: 3 },
            
            // Sidi Mabrouk
            { lat: 36.3490, lng: 6.5990, nom: "Station Taxi Sidi Mabrouk", type: "taxi", id: 7 },
            
            // Daksi
            { lat: 36.3390, lng: 6.5890, nom: "Station Taxi Daksi", type: "taxi", id: 9 },
            
            // Ain Smara
            { lat: 36.3290, lng: 6.5790, nom: "Station Taxi Ain Smara", type: "taxi", id: 10 },
            
            // Ain Bey
            { lat: 36.3810, lng: 6.5910, nom: "Station Taxi Ain Bey", type: "taxi", id: 20 },
            
            // ===== ALI MENDJLI STATIONS DE TAXI - COORDONN√âES CORRECTES =====
            { lat: 36.3075, lng: 6.5825, nom: "Station Taxi Ali Mendjli Centre Principal", type: "taxi", id: 13 },
            { lat: 36.3115, lng: 6.5865, nom: "Station Taxi Ali Mendjli Nord", type: "taxi", id: 14 },
            { lat: 36.3025, lng: 6.5775, nom: "Station Taxi Ali Mendjli Sud", type: "taxi", id: 15 },
            { lat: 36.3085, lng: 6.5895, nom: "Station Taxi Ali Mendjli Est", type: "taxi", id: 16 },
            { lat: 36.3080, lng: 6.5745, nom: "Station Taxi Ali Mendjli Ouest", type: "taxi", id: 17 },
            { lat: 36.3065, lng: 6.5815, nom: "Station Taxi Ali Mendjli Terminal", type: "taxi", id: 18 },
            { lat: 36.3095, lng: 6.5855, nom: "Station Taxi Ali Mendjli Commercial", type: "taxi", id: 19 },
            { lat: 36.3145, lng: 6.5805, nom: "Station Taxi Ali Mendjli Universit√©", type: "taxi", id: 21 },
            { lat: 36.3015, lng: 6.5765, nom: "Station Taxi Ali Mendjli R√©sidentiel", type: "taxi", id: 22 },
            { lat: 36.3055, lng: 6.5885, nom: "Station Taxi Ali Mendjli Gare", type: "taxi", id: 23 },
            
            // El Khroub
            { lat: 36.4550, lng: 6.6910, nom: "Station Taxi El Khroub Centre", type: "taxi", id: 30 }
        ];
        
        // Donn√©es des taxis irr√©guliers (points rouges) - ALI MENDJLI CORRIG√â
        const taxisIrreguliers = [
            // Constantine Centre
            { lat: 36.3675, lng: 6.6135, nom: "Taxi Irr√©gulier Pont Sidi M'Cid", type: "taxi_irreg", id: 1 },
            { lat: 36.3655, lng: 6.6175, nom: "Taxi Irr√©gulier Centre", type: "taxi_irreg", id: 2 },
            
            // Sidi Mabrouk
            { lat: 36.3485, lng: 6.5995, nom: "Taxi Irr√©gulier Sidi Mabrouk", type: "taxi_irreg", id: 5 },
            
            // Daksi
            { lat: 36.3395, lng: 6.5895, nom: "Taxi Irr√©gulier Daksi", type: "taxi_irreg", id: 7 },
            
            // Ain Smara
            { lat: 36.3295, lng: 6.5795, nom: "Taxi Irr√©gulier Ain Smara", type: "taxi_irreg", id: 8 },
            
            // ===== ALI MENDJLI TAXIS IRR√âGULIERS - COORDONN√âES CORRECTES =====
            { lat: 36.3070, lng: 6.5820, nom: "Taxi Irr√©gulier Ali Mendjli Centre 1", type: "taxi_irreg", id: 12 },
            { lat: 36.3090, lng: 6.5840, nom: "Taxi Irr√©gulier Ali Mendjli Centre 2", type: "taxi_irreg", id: 13 },
            { lat: 36.3110, lng: 6.5860, nom: "Taxi Irr√©gulier Ali Mendjli Nord 1", type: "taxi_irreg", id: 14 },
            { lat: 36.3130, lng: 6.5880, nom: "Taxi Irr√©gulier Ali Mendjli Nord 2", type: "taxi_irreg", id: 15 },
            { lat: 36.3020, lng: 6.5770, nom: "Taxi Irr√©gulier Ali Mendjli Sud 1", type: "taxi_irreg", id: 16 },
            { lat: 36.3040, lng: 6.5790, nom: "Taxi Irr√©gulier Ali Mendjli Sud 2", type: "taxi_irreg", id: 17 },
            { lat: 36.3080, lng: 6.5890, nom: "Taxi Irr√©gulier Ali Mendjli Est", type: "taxi_irreg", id: 18 },
            { lat: 36.3090, lng: 6.5750, nom: "Taxi Irr√©gulier Ali Mendjli Ouest", type: "taxi_irreg", id: 19 },
            { lat: 36.3150, lng: 6.5810, nom: "Taxi Irr√©gulier Ali Mendjli Universit√©", type: "taxi_irreg", id: 20 },
            { lat: 36.3010, lng: 6.5760, nom: "Taxi Irr√©gulier Ali Mendjli R√©sidentiel", type: "taxi_irreg", id: 21 },
            
            // El Khroub
            { lat: 36.4545, lng: 6.6905, nom: "Taxi Irr√©gulier El Khroub Centre", type: "taxi_irreg", id: 25 }
        ];
        
        // Configuration des styles avec les couleurs demand√©es
        const styles = {
            bus: { color: '#0066ff', fillColor: '#0066ff', radius: 8 },
            taxi: { color: '#ffff00', fillColor: '#ffff00', radius: 8 },
            taxi_irreg: { color: '#ff0000', fillColor: '#ff0000', radius: 8 }
        };
        
        // Initialisation de la carte
        function initMap() {
            // Masquer le loading
            document.getElementById('loading').style.display = 'none';
            
            // Cr√©er la carte centr√©e sur Constantine avec zoom ajust√©
            const map = L.map('map').setView([36.365, 6.6147], 11);
            
            // Ajouter les tuiles OpenStreetMap
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);
            
            // Fonction pour cr√©er un marqueur
            function createMarker(point, style) {
                const marker = L.circleMarker([point.lat, point.lng], {
                    color: '#333',
                    weight: 2,
                    fillColor: style.fillColor,
                    fillOpacity: 0.8,
                    radius: style.radius
                });
                
                // Popup avec informations d√©taill√©es
                const popupContent = `
                    <div class="popup-content">
                        <h3>${point.nom}</h3>
                        <p><strong>ID:</strong> ${point.id}</p>
                        <p><strong>Type:</strong> ${getTypeLabel(point.type)}</p>
                        <p><strong>Coordonn√©es:</strong> ${point.lat.toFixed(4)}, ${point.lng.toFixed(4)}</p>
                    </div>
                `;
                
                marker.bindPopup(popupContent);
                return marker;
            }
            
            // Fonction pour obtenir le label du type
            function getTypeLabel(type) {
                switch(type) {
                    case 'bus': return 'Arr√™t de Bus';
                    case 'taxi': return 'Station de Taxi';
                    case 'taxi_irreg': return 'Taxi Irr√©gulier';
                    default: return 'Inconnu';
                }
            }
            
            // Ajouter tous les marqueurs pour chaque type
            console.log('Ajout des arr√™ts de bus:', arretsBus.length);
            arretsBus.forEach(point => {
                createMarker(point, styles.bus).addTo(map);
            });
            
            console.log('Ajout des stations de taxi:', arretsTaxi.length);
            arretsTaxi.forEach(point => {
                createMarker(point, styles.taxi).addTo(map);
            });
            
            console.log('Ajout des taxis irr√©guliers:', taxisIrreguliers.length);
            taxisIrreguliers.forEach(point => {
                createMarker(point, styles.taxi_irreg).addTo(map);
            });
            
            // Ajouter la l√©gende
            const legend = L.control({ position: 'bottomright' });
            legend.onAdd = function() {
                const div = L.DomUtil.create('div', 'legend');
                div.innerHTML = `
                    <h4>L√©gende</h4>
                    <div class="legend-item">
                        <span class="legend-color" style="background-color: #0066ff;"></span>
                        Arr√™ts de Bus
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background-color: #ffff00; border: 1px solid #ccc;"></span>
                        Stations de Taxi
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background-color: #ff0000;"></span>
                        Taxis Irr√©guliers
                    </div>
                `;
                return div;
            };
            legend.addTo(map);
            
            // Ajouter un contr√¥le d'√©chelle
            L.control.scale().addTo(map);
            
            // Calculer les limites pour centrer la vue sur tous les points
            const allPoints = [...arretsBus, ...arretsTaxi, ...taxisIrreguliers];
            if (allPoints.length > 0) {
                const group = new L.featureGroup(
                    allPoints.map(point => L.marker([point.lat, point.lng]))
                );
                map.fitBounds(group.getBounds().pad(0.1));
            }
            
            console.log('Carte interactive charg√©e avec succ√®s');
            console.log(`Total des points affich√©s: ${allPoints.length}`);
            console.log('- Arr√™ts de bus:', arretsBus.length);
            console.log('- Stations de taxi:', arretsTaxi.length);
            console.log('- Taxis irr√©guliers:', taxisIrreguliers.length);
            console.log('POINTS ALI MENDJLI REPOSITIONN√âS CORRECTEMENT !');
        }
        
        // Initialiser la carte quand la page est charg√©e
        document.addEventListener('DOMContentLoaded', initMap);
    </script>
</body>
</html>
